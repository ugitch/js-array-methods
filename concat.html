<script src="../simpletest.js"></script>
<script>

// Prototype
// function concat(array) {
//   // 1. copy array to returnArray
//   // 2. check if optional arguments
//   // 3. check every argument if array or value
//   // 4a. traverse array and add elements
//   // 4b. add regular elements
//   // 5. return returnArray
// }

// Function signature
  // concat(array[, value1[, value2])

// Function parameters
  // array
  // value1, value2,...valueN ~ optional values or arrays

// Return value
  // returns new array

// Function description
  // Creates a new array consisting of the 'array' elements, followed by argument(s)' element(s) in case of array(s), or argument(s) in case of value(s).

// Requirements:
  // It should return a new array.
  // If one argument, return copy of an array.
  // If an optional argument is not an array, it should add it to the returnArray.
  // If an optional argument is an array, it should add its elements to the returnArray.

  // It should work for multiple optional arguments.
  // It should work for mixture of optional arguments, arrays and not arrays.
  
  // It should not modify array(s).
  // If an element is an object, it should copy its reference into the returnArray.
  // It should not recurse into nested array arguments.

function concat(array) {
  // return new array
  var returnArray = array.slice();

  // check if any optional arguments
  if (arguments.length > 1) {
    // traverse optional arguments
    for (var i = 1; i < arguments.length; i++) {
      // check if an array
      if (Array.isArray(arguments[i])) {
        var length = arguments[i].length;
        for (var j = 0; j < length; j++) {
          returnArray.push(arguments[i][j]);
        }
      }
      // add non-array argument to new array
      else {
        returnArray.push(arguments[i]);
      }
    }
  }

  return returnArray;
}

tests({
  'It should return a new array.': function() {
    var array = [1];
    var result = concat(array);
    eq(result !== array, true);
  },
  'If one argument, return copy of an array.': function() {
    var array = [1];
    var result = concat(array);
    eq(array[0], result[0]);
    eq(array.length, result.length);
  },
  'If an optional argument is not an array, it should add it to the returnArray.': function() {    
    var result = concat([1], true);
    eq(result[1], true);
    eq(result.length, 2);
  },
  'If an optional argument is an array, it should add its elements to the returnArray.': function() {
    var result = concat([1], [2, 3]);
    eq(result[1], 2);
    eq(result[2], 3);
    eq(result.length, 3);
  },

  'It should work for multiple optional arguments.': function() {
    var result = concat([1], [2], [5]);
    eq(result[1], 2);
    eq(result[2], 5);
    eq(result.length, 3);
  },
  'It should work for mixture of optional arguments, arrays and not arrays.': function() {
    var result = concat([], [2], 3, [5]);
    eq(result[0], 2);
    eq(result[1], 3);
    eq(result[2], 5);
    eq(result.length, 3);
  },

  'It should not modify array(s).': function() {
    var array = [1, 2];
    var result = concat([1], array);
    eq(array[0], 1);
    eq(array[1], 2);
    eq(array.length, 2);
  },
  'If an element is an object, it should copy object reference into returnArray.': function() {
    var testArray = [1];
    var objectElem = {name: 'Gordon'};
    var resultArray = concat(testArray, objectElem);
    resultArray[1].name = 'Ugitch';
    eq(objectElem.name, 'Ugitch');
  },
  'It should not recurse into nested array arguments.': function() {
    var result = concat([1], [[1, 2]]);
    eq(result[1][0], 1);
    eq(result[1][1], 2);
    eq(result[1].length, 2);
    eq(result.length, 2);
  }
});

</script>